

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## ARM 

```{r cars}


```

## Including Plots

You can also embed plots, for example:

```{r, echo=FALSE}
library(viridis)
library(arules)
library(TSP)
library(data.table)
#library(ggplot2)
#library(Matrix)
library(tcltk)
library(dplyr)
library(devtools)
library(purrr)
library(tidyr)
# Load packages
library(networkD3)
library(arules)
library(ROAuth)
library(jsonlite)
# library(rjson)
library(tokenizers)
library(tidyverse)
library(plyr)
library(dplyr)
library(ggplot2)
#install.packages("syuzhet")  
## for sentiment analysis
library(syuzhet)
library(stringr)
library(arulesViz)
library(igraph)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
```{r}
DisasterTransaction <- read.transactions("/Users/anitateladevalapalli/Documents/Text Mining/TM_project/Data/transaction.csv",rm.duplicates = FALSE, format = "basket", sep=",",cols=1) ## The dataset HAS row numbers
inspect(DisasterTransaction)
```
```

```{r}
Trans = file(DisasterTransaction)
Tokens = tokenizers::tokenize_words(df$Text[1], stopwords = stopwords::stopwords("en"), lowercase =TRUE, strip_punct = TRUE, strip_numeric = TRUE, simplify = TRUE)
```

```{r}
cat(unlist(str_squish(Tokens)), "\n", file = Trans, sep = ",")
close(Trans)

```

```{r}

Trans = file(TransactionFile, open="a" )
for(i in 2:nrow(df)){
  Tokens = tokenizers::tokenize_words(df$Text[i], stopwords = stopwords::stopwords("en"), lowercase = TRUE, 
                                      strip_punct = TRUE, strip_numeric = TRUE, simplify = TRUE)
  cat(unlist(str_squish(Tokens)), "\n", file = Trans, sep = ",")
  
}
close(Trans)

```

```{r}
DF = read.csv(TransactionFile, header = FALSE, sep= ",")
head(DF)
```


```{r}
(str(DF))
```


```{r}
DF = DF %>%
  mutate_all(as.character)
```


```{r}

myDF = NULL
for(i in 1:ncol(DF)){
  MyList = c()
  MyList = c(MyList, grepl("[[:digit:]]", DF[[i]]))
  myDF = cbind(myDF, MyList)
}
```


```{r}
DF[myDF] <- ""
(DF)
```


```{r}

MyDF<-NULL
MyDF2<-NULL
for (i in 1:ncol(DF)){
  MyList=c() 
  MyList2=c() # each list is a column of logicals ...
  MyList=c(MyList,grepl("[[:digit:]]", DF[[i]]))
  MyDF<-cbind(MyDF,MyList)  ## create a logical DF
  MyList2=c(MyList2,(nchar(DF[[i]])<4 | nchar(DF[[i]])>11))
  MyDF2<-cbind(MyDF2,MyList2) 
  ## TRUE is when a cell has a word that contains digits
}
## For all TRUE, replace with blank
DF[MyDF] <- ""
DF[MyDF2] <- ""
(head(DF,10))
```
```{r}
write.table(DF, file = "UpdatedFile.csv", col.names = FALSE, 
            row.names = FALSE, sep = ",")
TweetTrans <- read.transactions("UpdatedFile.csv", sep =",", 
                                format("basket"),  rm.duplicates = TRUE)
#inspect(TweetTrans)

```


```{r}
TweetTrans_rules = arules::apriori(TweetTrans, 
        parameter = list(support=.06, conf=1, minlen=2))
        #maxlen
        #appearance = list (default="lhs",rhs="milk")
head(TweetTrans_rules,10)

```


```{r}

plot(sortedRules_sup[1:7], method = "graph", engine = 'interactive', shading = "confidence")

```


```{r}
```

